' This Class has been autogenerated by Nodalsoft
' Do NOT adjust as it will be overwritten
' Generation Date : 13/02/2008 09:42:50
'
'
Public Class cPrMsPeriodEarningsDbTier
    '
    Inherits cDataTier
    '
    Protected Function GetByPK(ByVal tId As Integer) As DataSet
        Dim Str As String
        Str = " SELECT" & _
                " PrdErn_id," & _
                " PrdCod_Code," & _
                " PrdGrp_Code," & _
                " ErnCod_Code," & _
                " PrdErn_IsActive" & _
            "  FROM PrMsPeriodEarnings" & _
            "  WHERE PrdErn_id = " & tId
        Return MyBase.GetData(Str)
    End Function
    Protected Function GetByPK(ByVal tPerCode As String, ByVal tPerGroup As String, ByVal tEDCCode As String) As DataSet
        Dim Str As String
        Str = " SELECT" & _
                " PrdErn_id," & _
                " PrdCod_Code," & _
                " PrdGrp_Code," & _
                " ErnCod_Code," & _
                " PrdErn_IsActive" & _
                "  FROM PrMsPeriodEarnings " & _
                "  WHERE  PrdCod_Code = " & enQuoteString(tPerCode) & _
                " and PrdGrp_Code = " & enQuoteString(tPerGroup) & _
                " and ErnCod_Code = " & enQuoteString(tEDCCode)

        Return MyBase.GetData(Str)
    End Function
    Protected Function Save(ByRef _cPrMsPeriodEarnings As cPrMsPeriodEarnings) As Boolean
        Dim SpParams As New ArrayList
        Dim SpNames As New ArrayList
        Dim Flag As Boolean = False
        With _cPrMsPeriodEarnings
            SpParams.Add(.Id)                                                '(0)
            SpNames.Add("PrdErn_id")                                         '(0)
            SpParams.Add(.PrdCodCode)                                        '(1)
            SpNames.Add("PrdCod_Code")                                       '(1)
            SpParams.Add(.PrdgrpCode)                                        '(1)
            SpNames.Add("PrdGrp_Code")                                       '(1)
            SpParams.Add(.ErnCodCode)                                        '(2)
            SpNames.Add("ErnCod_Code")                                       '(2)
            SpParams.Add(.IsActive)                                          '(3)
            SpNames.Add("PrdErn_IsActive")                                   '(3)
        End With
        SpNames.Add("NewId")                                             '(4)
        SpParams.Add(CInt(0))                                            '(4)
        If Me.StoredProcedure("AG_PrMsPeriodEarnings_Save_Update", SpParams, SpNames, 5) Then
            If _cPrMsPeriodEarnings.Id = 0 Then
                _cPrMsPeriodEarnings.Id = DbNullToInt(SpParams(5))
            End If
            Return True
        Else
            Return False
        End If
    End Function
    Protected Function Delete(ByVal tId As Integer) As Boolean
        Dim Str As String
        Dim Flag As Boolean = True
        Dim Exx As New System.Exception
        Try
            BeginTransaction()
            Str = " DELETE FROM PrMsPeriodEarnings" & _
               " WHERE PrdErn_id = " & tId
            If MyBase.ExecuteNonQuery(Str) = -1 Then
                Throw Exx
            End If
            CommitTransaction()
        Catch ex As Exception
            Rollback()
            Utils.ShowException(ex)
            Flag = False
        End Try
        Return Flag
    End Function
    Protected Function CheckDeleteRecords(ByVal tCode As Integer) As DataSet
        Dim ds As DataSet
        '    Generation Note : 13/02/2008 09:42:50 :- No Foriegn Key Constraints where found
        ds = Nothing
        Return ds
    End Function
End Class
