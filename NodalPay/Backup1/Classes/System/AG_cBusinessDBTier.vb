' This Class has been autogenerated by Nodalsoft
' Do NOT adjust as it will be overwritten
' Generation Date : 30/06/2008 10:46:17
'
'
Partial Public Class cBusinessDBTier
    '
    Inherits cDataTier
    '
    Protected Function AG_GetAllAaSsParameters() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " Par_Id," & _
            " Par_Section," & _
            " Par_Item," & _
            " Par_Value," & _
            " Par_Description," & _
            " Par_System," & _
            " Par_Type" & _
            " FROM AaSsParameters"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllAaSsPlaceHolder() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " AaSsPlaceHolder_dim_Key," & _
            " AaSsPlaceHolder_dim_Value" & _
            " FROM AaSsPlaceHolder"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllAaSsUsers() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " Usr_Id," & _
            " Usr_UserName," & _
            " Usr_FullName," & _
            " Usr_CreatedOn," & _
            " Usr_IsEnabled," & _
            " Usr_IsSA," & _
            " Usr_MyRole" & _
            " FROM AaSsUsers"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllAdAnCountries() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " Cou_Code," & _
            " Cou_DescriptionL," & _
            " Cou_IsActive" & _
            " FROM AdAnCountries"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllAdMsCurrency() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " Cur_AlphaCode," & _
            " Cur_NumericCode," & _
            " Cur_Description," & _
            " Cur_Symbol," & _
            " Cur_IsActive" & _
            " FROM AdMsCurrency"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllAdMsCurrencyRates() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " CurRte_id," & _
            " Cur_AlphaCode," & _
            " CurRte_Rate," & _
            " CurRte_EffectiveDate," & _
            " CurRte_CreatedBy," & _
            " CurRte_CreationDate," & _
            " CurRte_AmendBy," & _
            " CurRte_AmendDate," & _
            "(select Usr_FullName from AaSsUsers where CurRte_CreatedBy = Usr_Id)as CurRte_CreatedByName, " & _
            "(select Usr_FullName from AaSsUsers where CurRte_AmendBy = Usr_Id) as CurRte_AmendByName  " & _
            " FROM AdMsCurrencyRates"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrAnBanks() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " Bnk_Code," & _
            " Bnk_DescriptionL," & _
            " Bnk_DescriptionS," & _
            " Bnk_IsActive," & _
            " Bnk_TransferCode," & _
            " Bnk_SwiftCode" & _
            " FROM PrAnBanks"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrAnEmployeeAnalysis1() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " EmpAn1_Code," & _
            " EmpAn1_DescriptionL," & _
            " EmpAn1_DescriptionS," & _
            " EmpAn1_IsActive," & _
            " EmpAn1_GLAnal1," & _
            " EmpAn1_GLAnal2," & _
            " EmpAn1_CreationDate," & _
            " EmpAn1_AmendDate" & _
            " FROM PrAnEmployeeAnalysis1"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrAnEmployeeAnalysis2() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " EmpAn2_Code," & _
            " EmpAn2_DescriptionL," & _
            " EmpAn2_DescriptionS," & _
            " EmpAn2_IsActive," & _
            " EmpAn2_GLAnal1," & _
            " EmpAn2_GLAnal2," & _
            " EmpAn2_CreationDate," & _
            " EmpAn2_AmendDate" & _
            " FROM PrAnEmployeeAnalysis2"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrAnEmployeeAnalysis3() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " EmpAn3_Code," & _
            " EmpAn3_DescriptionL," & _
            " EmpAn3_DescriptionS," & _
            " EmpAn3_IsActive," & _
            " EmpAn3_GLAnal1," & _
            " EmpAn3_GLAnal2," & _
            " EmpAn3_CreationDate," & _
            " EmpAn3_AmendDate" & _
            " FROM PrAnEmployeeAnalysis3"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrAnEmployeeAnalysis4() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " EmpAn4_Code," & _
            " EmpAn4_DescriptionL," & _
            " EmpAn4_DescriptionS," & _
            " EmpAn4_IsActive," & _
            " EmpAn4_GLAnal1," & _
            " EmpAn4_GLAnal2," & _
            " EmpAn4_CreationDate," & _
            " EmpAn4_AmendDate" & _
            " FROM PrAnEmployeeAnalysis4"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrAnEmployeeAnalysis5() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " EmpAn5_Code," & _
            " EmpAn5_DescriptionL," & _
            " EmpAn5_DescriptionS," & _
            " EmpAn5_IsActive," & _
            " EmpAn5_GLAnal1," & _
            " EmpAn5_GLAnal2," & _
            " EmpAn5_CreationDate," & _
            " EmpAn5_AmendDate" & _
            " FROM PrAnEmployeeAnalysis5"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrAnEmployeeCommunity() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " EmpCmm_Code," & _
            " EmpCmm_DescriptionL," & _
            " EmpCmm_DescriptionS," & _
            " EmpCmm_IsActive," & _
            " EmpCmm_Sequence" & _
            " FROM PrAnEmployeeCommunity"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrAnEmployeePositions(ByVal SortByDesc As String) As DataSet
        Dim Str As String
        Dim Str2 As String = ""
        Str = " SELECT " & _
            " EmpPos_Code," & _
            " EmpPos_DescriptionL," & _
            " EmpPos_DescriptionS," & _
            " EmpPos_IsActive," & _
            " EmpPos_Units " & _
            " FROM PrAnEmployeePositions"
        If SortByDesc Then
            Str2 = " Order by EmpPos_DescriptionL"
        End If

        Str = Str & Str2
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrAnEmploymentStatus() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " EmpSta_Code," & _
            " EmpSta_DescriptionL," & _
            " EmpSta_DescriptionS," & _
            " EmpSta_IsActive" & _
            " FROM PrAnEmploymentStatus"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrAnMarritalStatus() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " MarSta_Code," & _
            " MarSta_DescriptionL," & _
            " MarSta_DescriptionS," & _
            " MarSta_Sequence" & _
            " FROM PrAnMarritalStatus"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrAnPaymentMethods() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " PmtMth_Code," & _
            " PmtMth_DescriptionL," & _
            " PmtMth_DescriptionS," & _
            " PmtMth_IsActive" & _
            " FROM PrAnPaymentMethods"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrAnSocialInsCategories() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " Sic_Code," & _
            " Sic_DescriptionL," & _
            " Sic_DescriptionS," & _
            " Sic_IsActive," & _
            " Sic_Sequence" & _
            " FROM PrAnSocialInsCategories" & _
            " Order By Sic_Sequence Asc"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrAnTaxCardType() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " TicTyp_Code," & _
            " TicTyp_DescriptionL," & _
            " TicTyp_DescriptionS," & _
            " TicTyp_IsActive" & _
            " FROM PrAnTaxCardType"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrAnUnions() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " Uni_Code," & _
            " Uni_DescriptionL," & _
            " Uni_DescriptionS," & _
            " Uni_IsActive," & _
            " Uni_SubscriptionType," & _
            " Uni_GLAnal1," & _
            " Uni_GLAnal2," & _
            " Uni_SubscriptionValue," & _
            " Uni_CreationDate," & _
            " Uni_Deduction1," & _
            " Uni_Deduction2," & _
            " Uni_AmendDate," & _
            " Uni_WelfareRate," & _
            " Uni_WeeklyMF," & _
            " Uni_MonthlyMF," & _
            " Uni_WeeklySubLimit," & _
            " Uni_MonthlySubLimit" & _
            " FROM PrAnUnions"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrMsContributionCodes() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " ConCod_Code," & _
            " ConTyp_Code," & _
            " ConCod_DescriptionL," & _
            " ConCod_DescriptionS," & _
            " ConCod_IsActive" & _
            " FROM PrMsContributionCodes"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrMsDeductionCodes() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " DedCod_Code," & _
            " DedTyp_Code," & _
            " DedCod_DescriptionL," & _
            " DedCod_DescriptionS," & _
            " DedCod_IsActive" & _
            " FROM PrMsDeductionCodes"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrMsEarningCodes() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " ErnCod_Code," & _
            " ErnTyp_Code," & _
            " ErnCod_DescriptionL," & _
            " ErnCod_DescriptionS," & _
            " ErnCod_IsActive" & _
            " FROM PrMsEarningCodes"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrMsEmployeeContributions() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " EmpCon_Id," & _
            " Emp_Code," & _
            " ConCod_Code," & _
            " EmpCon_Value," & _
            " TemGrp_Code" & _
            " FROM PrMsEmployeeContributions"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrMsEmployeeDeductions() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " EmpDed_Id," & _
            " Emp_Code," & _
            " DedCod_Code," & _
            " EmpDed_Value," & _
            " TemGrp_Code" & _
            " FROM PrMsEmployeeDeductions"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrMsEmployeeEarnings() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " EmpErn_Id," & _
            " Emp_Code," & _
            " ErnCod_Code," & _
            " EmpErn_Value," & _
            " TemGrp_Code" & _
            " FROM PrMsEmployeeEarnings"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrMsEmployees1() As DataSet

        Dim Str2 As String
        Dim Ds As DataSet
        Ds = GetAllPrMsTemplateGroupOfUser(Global1.UserName)
        If CheckDataSet(Ds) Then
            Dim i As Integer
            For i = 0 To Ds.Tables(0).Rows.Count - 1
                If i = 0 Then
                    Str2 = " where TemGrp_Code =" & enQuoteString(Ds.Tables(0).Rows(i).Item(0))
                Else
                    Str2 = Str2 & " or TemGrp_Code =" & enQuoteString(Ds.Tables(0).Rows(i).Item(0))
                End If

            Next
        End If


        Dim Str As String
        Str = " SELECT " & _
            " Emp_Code," & _
            " Emp_Status," & _
            " PayTyp_Code," & _
            " TemGrp_Code," & _
            " EmpSta_Code," & _
            " Emp_Title," & _
            " Emp_LastName," & _
            " Emp_FirstName," & _
            " Emp_FullName," & _
            " Emp_Sex," & _
            " Emp_BirthDate," & _
            " MarSta_Code," & _
            " Emp_Address1," & _
            " Emp_Address2," & _
            " Emp_Address3," & _
            " Emp_PostCode," & _
            " Emp_Telephone1," & _
            " Emp_Telephone2," & _
            " Emp_Email," & _
            " Emp_Email2, " & _
            " Emp_SocialInsNumber," & _
            " ComSin_EmpSocialInsNo," & _
            " Emp_IdentificationCard," & _
            " Emp_TaxID," & _
            " Emp_PassportNumber," & _
            " Emp_AlienNumber," & _
            " TicTyp_Code," & _
            " EmpAn1_Code," & _
            " EmpAn2_Code," & _
            " EmpAn3_Code," & _
            " EmpAn4_Code," & _
            " EmpAn5_Code," & _
            " Uni_Code," & _
            " Cou_Code," & _
            " EmpPos_Code," & _
            " Sic_Code," & _
            " EmpCmm_Code," & _
            " PayUni_Code," & _
            " Emp_PeriodUnits," & _
            " Emp_AnnualUnits," & _
            " Cur_Code," & _
            " PmtMth_Code," & _
            " Bnk_Code," & _
            " Emp_BankAccount," & _
            " Bnk_CodeCo," & _
            " Emp_BankAccountCo," & _
            " Emp_StartDate," & _
            " Emp_TerminateDate," & _
            " Emp_OtherIncome1," & _
            " Emp_OtherIncome2," & _
            " Emp_OtherIncome3," & _
            " Emp_PreviousEarnings," & _
            " Emp_PrevSIDeduct," & _
            " Emp_PrevSIContribute," & _
            " Emp_PrevITDeduct," & _
            " Emp_PrevPFDeduct," & _
            " Emp_CreationDate," & _
            " Emp_CreatedBy," & _
            " Emp_AmendDate," & _
            " Emp_AmendBy," & _
            " IntTem_Code " & _
            " FROM PrMsEmployees"

        Str = Str & Str2

        Return GetData(Str)
    End Function
    Protected Function GetAllEmployeesForExcelWithSalary(ByVal PeriodGroupCode As String, ByVal Showdiscounts As Boolean) As DataSet

        Dim Str As String = ""
        Dim Str2 As String = ""
        Dim Str3 As String = ""

        Dim Ds As DataSet
        Ds = GetAllPrMsTemplateGroupOfUser(Global1.UserName)
        If CheckDataSet(Ds) Then
            Dim i As Integer
            For i = 0 To Ds.Tables(0).Rows.Count - 1
                If i = 0 Then
                    If showdiscounts Then
                        Str3 = " and TemGrp_Code =" & enQuoteString(Ds.Tables(0).Rows(i).Item(0))
                    Else
                        Str3 = " where TemGrp_Code =" & enQuoteString(Ds.Tables(0).Rows(i).Item(0))
                    End If
                Else
                    Str3 = Str3 & " or TemGrp_Code =" & enQuoteString(Ds.Tables(0).Rows(i).Item(0))
                End If

            Next
        End If


        Str = " SELECT PrMsEmployees.Emp_Code,   " & _
        " Emp_Status,   " & _
        " PayTyp_Code,   " & _
        " TemGrp_Code,   " & _
        " EmpSta_Code,    " & _
        " Emp_Title,   " & _
        " Emp_LastName,    " & _
        " Emp_FirstName,   " & _
        " Emp_FullName,   " & _
        " Emp_Sex,   " & _
        " Emp_BirthDate,    " & _
        " MarSta_Code,   " & _
        " Emp_Address1,   " & _
        " Emp_Address2,    " & _
        " Emp_Address3,   " & _
        " Emp_PostCode,   " & _
        " Emp_Telephone1,   " & _
        " Emp_Telephone2,   " & _
        " Emp_Email,   " & _
        " Emp_SocialInsNumber,    " & _
        " ComSin_EmpSocialInsNo,   " & _
        " Emp_IdentificationCard,    " & _
        " Emp_TaxID,   " & _
        " Emp_PassportNumber,   " & _
        " Emp_AlienNumber,   " & _
        " TicTyp_Code,    " & _
        " EmpAn1_Code,   " & _
        " EmpAn2_Code,    " & _
        " EmpAn3_Code,    " & _
        " EmpAn4_Code,   " & _
        " EmpAn5_Code,   " & _
        " Uni_Code,    " & _
        " Cou_Code,    " & _
        " EmpPos_Code,    " & _
        " Sic_Code,    " & _
        " EmpCmm_Code,    " & _
        " PayUni_Code,    " & _
        " Emp_PeriodUnits,   " & _
        " Emp_AnnualUnits,    " & _
        " Cur_Code,   " & _
        " PmtMth_Code,    " & _
        " Bnk_Code,    " & _
        " Emp_BankAccount,   " & _
        " Bnk_CodeCo,   " & _
        " Emp_BankAccountCo,   " & _
        " Emp_StartDate,   " & _
        " Emp_TerminateDate,   " & _
        " Emp_OtherIncome1,    " & _
        " Emp_OtherIncome2,   " & _
        " Emp_OtherIncome3,   " & _
        " Emp_PreviousEarnings,   " & _
        " Emp_PrevSIDeduct,   " & _
        " Emp_PrevSIContribute,   " & _
        " Emp_PrevITDeduct,   " & _
        " Emp_PrevPFDeduct,    " & _
        " Emp_PrevGesiD,    " & _
        " Emp_PrevGesiC,    " & _
        " ProFnd_Code,    " & _
        " MedFnd_Code,   " & _
        " SocInc_Code,   " & _
        " Ind_Code,   " & _
        " Une_Code,   " & _
        " SocCoh_Code,   " & _
        " Emp_CreationDate,   " & _
        " Emp_CreatedBy,    " & _
        " Emp_AmendDate,   " & _
        " Emp_AmendBy,    " & _
        " IntTem_Code,    " & _
        " Emp_GLAnal1,    " & _
        " Emp_GLAnal2,   " & _
        " Emp_GLAnal3,   " & _
        " Emp_GLAnal4,    " & _
        " IntTem_PFCode,   " & _
        " IntTem_MFCode,   " & _
        " Emp_PensionNo,   " & _
        " Emp_DrivingLicense,   " & _
        " Emp_HasSI,    " & _
        " Emp_PensionType,   " & _
        " Emp_MyPayslipREPort,   " & _
        " Emp_IBAN,   " & _
        " Emp_PreviousLifeIns,    " & _
        " EMp_PreviousDis,   " & _
        " Emp_PreviousST,   " & _
        " Emp_OtherIncome4,    " & _
        " SecPay_Code,    " & _
        " ComRat_Code,    " & _
        " PerBon_Code,    " & _
        " DutHou_Code,   " & _
        " FliHou_Code,    " & _
        " Emp_PassFullName,    " & _
        " Emp_TravelDocs,    " & _
        " Emp_FirstEmployment,   " & _
        " OveLay_Code,   " & _
        " Emp_Password,    " & _
        " Emp_Splitemployement,   " & _
        " Emp_NewEmployee,   " & _
        " Emp_Force50Percent,    " & _
        " Emp_Notes,    " & _
        " Emp_BankBenName,    " & _
        " Emp_AgreedSalary,    " & _
        " Emp_BonusOnSalary,    " & _
        " Emp_TaxForSplit,    " & _
        " Emp_50PerOff,   " & _
        " Emp_PrevMF,    " & _
        " Emp_PrevPenF,   " & _
        " Emp_50PerOff, " & _
        " Ges_Code, " & _
        " Emp_PrevGesiD," & _
        " Emp_PrevGesiC, " & _
        " Emp_LWBPen, " & _
        " Emp_GESYFromSplit, " & _
        " Emp_AnalGen1, " & _
        " Emp_NameDay, " & _
        " Emp_IsDirector, " & _
        " Emp_Rehire, " & _
        " Emp_CNP, " & _
        " Emp_TACode, " & _
        " Emp_HRCode, " & _
        " Emp_TermReason, " & _
        " Emp_HireReason, " & _
        " 0.00 as Salary "



        If Showdiscounts Then
            Str2 = " ,PrTxEmployeeDiscounts.EmpDis_Discount1, " & _
            " PrTxEmployeeDiscounts.EmpDis_Discount2, " & _
            " PrTxEmployeeDiscounts.EmpDis_Discount3, " & _
            " PrTxEmployeeDiscounts.EmpDis_Discount4, " & _
            " PrTxEmployeeDiscounts.EmpDis_Discount5, " & _
            " PrTxEmployeeDiscounts.EmpDis_Discount6, " & _
            " PrTxEmployeeDiscounts.EmpDis_Discount7,  " & _
            " PrTxEmployeeDiscounts.EmpDis_Discount8, " & _
            " PrTxEmployeeDiscounts.EmpDis_Discount9, " & _
            " PrTxEmployeeDiscounts.EmpDis_Discount10,  " & _
            " PrTxEmployeeDiscounts.EmpDis_LifeInsurance, " & _
            " PrTxEmployeeDiscounts.EmpDis_Medical " & _
            " FROM PrMsEmployees INNER JOIN  " & _
            " PrTxEmployeeDiscounts ON PrMsEmployees.Emp_Code = PrTxEmployeeDiscounts.Emp_Code" & _
            " where PrTxEmployeeDiscounts.PrdGrp_Code = " & enQuoteString(PeriodGroupCode)
        Else
            Str3 = " FROM PrMsEmployees " & Str3
        End If


        Str = Str & Str2 & str3


        Ds = GetData(Str)
        If CheckDataSet(Ds) Then
            Dim i As Integer
            Dim EmpCode As String = ""
            Dim Date1 As Date = Now.Date
            Dim Sal As cPrTxEmployeeSalary
            For i = 0 To Ds.Tables(0).Rows.Count - 1
                EmpCode = DbNullToString(Ds.Tables(0).Rows(i).Item(0))
                Sal = GetCurrentSalary(EmpCode, Date1)
                If Sal.Id <> 0 Then
                    Ds.Tables(0).Rows(i).Item(120) = Sal.SalaryValue
                End If
            Next
        End If
        Return Ds


    End Function

    Protected Function GetAllEmployeesFor_Report1(ByVal MyYear As String, ByVal CompanyCode As String) As DataSet

        Dim Str As String = ""
        Dim Str2 As String = ""
        Dim Str3 As String = ""
        Dim Ds As DataSet

        Str = "SELECT PrMsEmployees.Emp_Code, " & _
    " PrMsEmployees.Emp_FullName,  " & _
    " PrMsEmployees.Emp_Status,  " & _
    " PrMsEmployees.Emp_StartDate,  " & _
    " PrMsEmployees.Emp_TerminateDate, " & _
    " PrMsEmployees.EmpAn1_Code,  " & _
    " PrAnEmployeeAnalysis1.EmpAn1_DescriptionL, " & _
    " PrMsEmployees.EmpAn2_Code, " & _
    " PrAnEmployeeAnalysis2.EmpAn2_DescriptionL, " & _
    " PrMsEmployees.EmpAn3_Code,  " & _
    " PrAnEmployeeAnalysis3.EmpAn3_DescriptionL,  " & _
    " PrMsEmployees.EmpAn4_Code,  " & _
    " PrAnEmployeeAnalysis4.EmpAn4_DescriptionL, " & _
    " PrMsEmployees.EmpAn5_Code, " & _
    " PrAnEmployeeAnalysis5.EmpAn5_DescriptionL,  " & _
    " PrMsEmployees.EmpPos_Code,  " & _
    " PrAnEmployeePositions.EmpPos_DescriptionL " & _
    " FROM PrMsEmployees INNER JOIN " & _
    " PrAnEmployeeAnalysis1 ON PrMsEmployees.EmpAn1_Code = PrAnEmployeeAnalysis1.EmpAn1_Code INNER JOIN " & _
    " PrAnEmployeeAnalysis2 ON PrMsEmployees.EmpAn2_Code = PrAnEmployeeAnalysis2.EmpAn2_Code INNER JOIN " & _
    " PrAnEmployeeAnalysis3 ON PrMsEmployees.EmpAn3_Code = PrAnEmployeeAnalysis3.EmpAn3_Code INNER JOIN " & _
    " PrAnEmployeeAnalysis4 ON PrMsEmployees.EmpAn4_Code = PrAnEmployeeAnalysis4.EmpAn4_Code INNER JOIN " & _
    " PrAnEmployeeAnalysis5 ON PrMsEmployees.EmpAn5_Code = PrAnEmployeeAnalysis5.EmpAn5_Code INNER JOIN " & _
    " PrAnEmployeePositions ON PrMsEmployees.EmpPos_Code = PrAnEmployeePositions.EmpPos_Code  " & _
    " where emp_code in (select emp_code from prtxtrxnheader where PrTxTrxnHeader.TrxHdr_Year =" & enQuoteString(MyYear)

        If UCase(CompanyCode) <> "ALL" Then
            Str2 = " and PrTxTrxnHeader.Com_Code =" & enQuoteString(CompanyCode) & ")"
        Else
            Str2 = " )"
        End If
        Str3 = " order by Emp_Code ,TemGrp_Code "
        Str = Str & Str2 & Str3


        Ds = GetData(Str)

        Return Ds

    End Function
    Protected Function GetAllEmployeesFor_Report2(ByVal MyYear As String, ByVal CompanyCode As String) As DataSet

        Dim Str As String = ""
        Dim Str2 As String = ""
        Dim Str3 As String = ""
        Dim Ds As DataSet

        Str = " SELECT " & _
            " Emp_Code," & _
            " Emp_Status," & _
            " PayTyp_Code," & _
            " TemGrp_Code," & _
            " EmpSta_Code," & _
            " Emp_Title," & _
            " Emp_LastName," & _
            " Emp_FirstName," & _
            " Emp_FullName," & _
            " Emp_Sex," & _
            " Emp_BirthDate," & _
            " MarSta_Code," & _
            " Emp_Address1," & _
            " Emp_Address2," & _
            " Emp_Address3," & _
            " Emp_PostCode," & _
            " Emp_Telephone1," & _
            " Emp_Telephone2," & _
            " Emp_Email," & _
            " Emp_SocialInsNumber," & _
            " ComSin_EmpSocialInsNo," & _
            " Emp_IdentificationCard," & _
            " Emp_TaxID," & _
            " Emp_PassportNumber," & _
            " Emp_AlienNumber," & _
            " TicTyp_Code," & _
            " PrMsEmployees.EmpAn1_Code," & _
            " PrAnEmployeeAnalysis1.EmpAn1_DescriptionL, " & _
            " PrMsEmployees.EmpAn2_Code," & _
            " PrAnEmployeeAnalysis2.EmpAn2_DescriptionL, " & _
            " PrMsEmployees.EmpAn3_Code," & _
            " PrAnEmployeeAnalysis3.EmpAn3_DescriptionL,  " & _
            " PrMsEmployees.EmpAn4_Code," & _
            " PrAnEmployeeAnalysis4.EmpAn4_DescriptionL, " & _
            " PrMsEmployees.EmpAn5_Code," & _
            " PrAnEmployeeAnalysis5.EmpAn5_DescriptionL,  " & _
            " Emp_AnalGen1," & _
            " Uni_Code," & _
            " Cou_Code," & _
            " PrMsEmployees.EmpPos_Code," & _
            " PrAnEmployeePositions.EmpPos_DescriptionL, " & _
            " Sic_Code," & _
            " EmpCmm_Code," & _
            " PayUni_Code," & _
            " Emp_PeriodUnits," & _
            " Emp_AnnualUnits," & _
            " Cur_Code," & _
            " PmtMth_Code," & _
            " Bnk_Code," & _
            " Emp_BankAccount," & _
            " Bnk_CodeCo," & _
            " Emp_BankAccountCo," & _
            " Emp_StartDate," & _
            " Emp_TerminateDate," & _
            " Emp_OtherIncome1," & _
            " Emp_OtherIncome2," & _
            " Emp_OtherIncome3," & _
            " Emp_PreviousEarnings," & _
            " Emp_PrevSIDeduct," & _
            " Emp_PrevSIContribute," & _
            " Emp_PrevITDeduct," & _
            " Emp_PrevPFDeduct," & _
            " Emp_CreationDate," & _
            " Emp_CreatedBy," & _
            " Emp_AmendDate," & _
            " Emp_AmendBy" & _
            " FROM PrMsEmployees INNER JOIN " & _
            " PrAnEmployeeAnalysis1 ON PrMsEmployees.EmpAn1_Code = PrAnEmployeeAnalysis1.EmpAn1_Code INNER JOIN " & _
            " PrAnEmployeeAnalysis2 ON PrMsEmployees.EmpAn2_Code = PrAnEmployeeAnalysis2.EmpAn2_Code INNER JOIN " & _
            " PrAnEmployeeAnalysis3 ON PrMsEmployees.EmpAn3_Code = PrAnEmployeeAnalysis3.EmpAn3_Code INNER JOIN " & _
            " PrAnEmployeeAnalysis4 ON PrMsEmployees.EmpAn4_Code = PrAnEmployeeAnalysis4.EmpAn4_Code INNER JOIN " & _
            " PrAnEmployeeAnalysis5 ON PrMsEmployees.EmpAn5_Code = PrAnEmployeeAnalysis5.EmpAn5_Code INNER JOIN " & _
            " PrAnEmployeePositions ON PrMsEmployees.EmpPos_Code = PrAnEmployeePositions.EmpPos_Code  " & _
            " where emp_code in (select emp_code from prtxtrxnheader where PrTxTrxnHeader.TrxHdr_Year =" & enQuoteString(MyYear)

        If UCase(CompanyCode) <> "ALL" Then
            Str2 = " and PrTxTrxnHeader.Com_Code =" & enQuoteString(CompanyCode) & ")"
        Else
            Str2 = " )"
        End If
        Str3 = " order by Emp_Code ,TemGrp_Code "
        Str = Str & Str2 & Str3


        Ds = GetData(Str)

        Return Ds

    End Function
    Protected Function GetAllEmployeesFor_EmployeesWithPF(ByVal CompanyCode As String, ByVal OnlyEmployeesWithNonZeroPF As Boolean) As DataSet

        Dim Str As String = ""
        Dim Str2 As String = ""
        Dim Str3 As String = ""
        Dim str4 As String = ""
        Dim Ds As DataSet

        Str = " SELECT " & _
            " Emp_Code," & _
            " Emp_Status," & _
            " TemGrp_Code," & _
            " EmpSta_Code," & _
            " Emp_Title," & _
            " Emp_LastName," & _
            " Emp_FirstName," & _
            " Emp_FullName," & _
            " Emp_Sex," & _
            " Emp_BirthDate," & _
            " MarSta_Code," & _
            " Emp_Address1," & _
            " Emp_Address2," & _
            " Emp_Address3," & _
            " Emp_PostCode," & _
            " Emp_Telephone1," & _
            " Emp_Telephone2," & _
            " Emp_Email," & _
            " Emp_SocialInsNumber," & _
            " ComSin_EmpSocialInsNo," & _
            " Emp_IdentificationCard," & _
            " Emp_TaxID," & _
            " Emp_PassportNumber," & _
            " Emp_AlienNumber," & _
            " TicTyp_Code," & _
            " PrMsEmployees.EmpAn1_Code," & _
            " PrAnEmployeeAnalysis1.EmpAn1_DescriptionL, " & _
            " PrMsEmployees.EmpAn2_Code," & _
            " PrAnEmployeeAnalysis2.EmpAn2_DescriptionL, " & _
            " PrMsEmployees.EmpAn3_Code," & _
            " PrAnEmployeeAnalysis3.EmpAn3_DescriptionL,  " & _
            " PrMsEmployees.EmpAn4_Code," & _
            " PrAnEmployeeAnalysis4.EmpAn4_DescriptionL, " & _
            " PrMsEmployees.EmpAn5_Code," & _
            " PrAnEmployeeAnalysis5.EmpAn5_DescriptionL,  " & _
            " Emp_AnalGen1," & _
            " Uni_Code," & _
            " Cou_Code," & _
            " PrMsEmployees.EmpPos_Code," & _
            " PrAnEmployeePositions.EmpPos_DescriptionL, " & _
            " Sic_Code," & _
            " EmpCmm_Code," & _
            " PayUni_Code," & _
            " Emp_PeriodUnits," & _
            " Emp_AnnualUnits," & _
            " Cur_Code," & _
            " PmtMth_Code," & _
            " Bnk_Code," & _
            " Emp_BankAccount," & _
            " Bnk_CodeCo," & _
            " Emp_BankAccountCo," & _
            " Emp_StartDate," & _
            " Emp_TerminateDate," & _
            " Emp_OtherIncome1," & _
            " Emp_OtherIncome2," & _
            " Emp_OtherIncome3," & _
            " Emp_PreviousEarnings," & _
            " Emp_PrevSIDeduct," & _
            " Emp_PrevSIContribute," & _
            " Emp_PrevITDeduct," & _
            " Emp_PrevPFDeduct," & _
            " Emp_CreationDate," & _
            " Emp_CreatedBy," & _
            " Emp_AmendDate," & _
            " Emp_AmendBy," & _
            " PrSsProvidentFund.ProFnd_DedValue, " & _
            " PrSsProvidentFund.ProFnd_ConValue " & _
            " FROM PrMsEmployees INNER JOIN " & _
            " PrAnEmployeeAnalysis1 ON PrMsEmployees.EmpAn1_Code = PrAnEmployeeAnalysis1.EmpAn1_Code INNER JOIN " & _
            " PrAnEmployeeAnalysis2 ON PrMsEmployees.EmpAn2_Code = PrAnEmployeeAnalysis2.EmpAn2_Code INNER JOIN " & _
            " PrAnEmployeeAnalysis3 ON PrMsEmployees.EmpAn3_Code = PrAnEmployeeAnalysis3.EmpAn3_Code INNER JOIN " & _
            " PrAnEmployeeAnalysis4 ON PrMsEmployees.EmpAn4_Code = PrAnEmployeeAnalysis4.EmpAn4_Code INNER JOIN " & _
            " PrAnEmployeeAnalysis5 ON PrMsEmployees.EmpAn5_Code = PrAnEmployeeAnalysis5.EmpAn5_Code INNER JOIN " & _
            " PrAnEmployeePositions ON PrMsEmployees.EmpPos_Code = PrAnEmployeePositions.EmpPos_Code INNER JOIN" & _
            " PrSsProvidentFund ON PrMsEmployees.ProFnd_Code = PrSsProvidentFund.ProFnd_Code"


        If UCase(CompanyCode) <> "ALL" And UCase(CompanyCode) <> "" Then
            Str2 = " where TemGrp_Code in (select TemGrp_Code from prmstemplategroup where Com_Code =" & enQuoteString(CompanyCode) & ")"
        End If
        If onlyEmployeesWithNonZeroPF Then
            If Str2 = "" Then
                Str3 = " Where "
            Else
                Str3 = " AND "
            End If
            Str3 = Str3 & "PrSsProvidentFund.ProFnd_DedValue<>0 and PrSsProvidentFund.ProFnd_ConValue<>0 "
        End If
        str4 = " order by Emp_Code ,TemGrp_Code "
        Str = Str & Str2 & Str3 & str4


        Ds = GetData(Str)

        Return Ds

    End Function

    Protected Function AG_GetAllPrMsPeriodCodes() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " PrdCod_Code," & _
            " PrdGrp_Code," & _
            " PrdCod_Status," & _
            " PrdCod_Number," & _
            " PrdCod_DescriptionL," & _
            " PrdCod_DescriptionS," & _
            " PrdCod_Sequence," & _
            " SinPrd_Code," & _
            " PrdCod_DateFrom," & _
            " PrdCod_DateTo," & _
            " PrdCod_PeriodUnits," & _
            " PayCat_Code" & _
            " FROM PrMsPeriodCodes"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrMsPeriodContributions() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " PrdCon_id," & _
            " PrdCod_Code," & _
            " ConCod_Code," & _
            " PrdCon_IsActive" & _
            " FROM PrMsPeriodContributions"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrMsPeriodDeductions() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " PrdDed_id," & _
            " PrdCod_Code," & _
            " DedCod_Code," & _
            " PrdDed_IsActive" & _
            " FROM PrMsPeriodDeductions"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrMsPeriodEarnings() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " PrdErn_id," & _
            " PrdCod_Code," & _
            " ErnCod_Code," & _
            " PrdErn_IsActive" & _
            " FROM PrMsPeriodEarnings"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrMsPeriodGroups() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " PrdGrp_Code," & _
            " PrdGrp_Status," & _
            " PrdGpr_Year," & _
            " TemGrp_Code," & _
            " PrdGrp_DescriptionL" & _
            " FROM PrMsPeriodGroups"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrMsTemplateContributions() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " TemCon_id," & _
            " TemGrp_Code," & _
            " ConCod_Code," & _
            " TemCon_DisplayName," & _
            " TemCon_IsDispalyed," & _
            " TemCon_Sequence," & _
            " TemCon_TypeMode," & _
            " TemCon_FromMode," & _
            " TemCon_CreationDate," & _
            " TemCon_CalcFormula," & _
            " TemCon_CreatedBy," & _
            " TemCon_AmendDate," & _
            " TemCon_AmendBy" & _
            " FROM PrMsTemplateContributions"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrMsTemplateDeductions() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " TemDed_id," & _
            " TemGrp_Code," & _
            " DedCod_Code," & _
            " TemDed_DisplayName," & _
            " TemDed_IsDispalyed," & _
            " TemDed_Sequence," & _
            " TemDed_TypeMode," & _
            " TemDed_FromMode," & _
            " TemDed_CreationDate," & _
            " TemDed_CalcFormula," & _
            " TemDed_CreatedBy," & _
            " TemDed_AmendDate," & _
            " TemDed_AmendBy" & _
            " FROM PrMsTemplateDeductions"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrMsTemplateEarnings() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " TemErn_id," & _
            " TemGrp_Code," & _
            " ErnCod_Code," & _
            " TemErn_DisplayName," & _
            " TemErn_IsDispalyed," & _
            " TemErn_Sequence," & _
            " TemErn_TypeMode," & _
            " TemErn_FromMode," & _
            " TemErn_CalcFormula," & _
            " TemErn_CreationDate," & _
            " TemErn_CreatedBy," & _
            " TemErn_AmendDate," & _
            " TemErn_AmendBy" & _
            " FROM PrMsTemplateEarnings"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrMsTemplateGroup() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " TemGrp_Code," & _
            " PayTyp_Code," & _
            " TemGrp_DescriptionL," & _
            " TemGrp_DescriptionS," & _
            " TemGrp_IsActive," & _
            " TemGrp_DayUnits," & _
            " TemGrp_GLAnl1," & _
            " TemGrp_GLAnl2, " & _
            " Com_Code " & _
            " FROM PrMsTemplateGroup"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsContributionTypes() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " ConTyp_Code," & _
            " ConTyp_DescriptionL," & _
            " ConTyp_DescriptionS," & _
            " ConTyp_TableSequence" & _
            " FROM PrSsContributionTypes" & _
            " Order by ConTyp_TableSequence"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsDeductionTypes() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " DedTyp_Code," & _
            " DedTyp_DescriptionL," & _
            " DedTyp_DescriptionS," & _
            " DedTyp_TableSequence" & _
            " FROM PrSsDeductionTypes" & _
            " Order by DedTyp_TableSequence"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsEarningTypes() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " ErnTyp_Code," & _
            " ErnTyp_DescriptionL," & _
            " ErnTyp_DescriptionS," & _
            " ErnTyp_TableSequence" & _
            " FROM PrSsEarningTypes" & _
            " Order by ErnTyp_TableSequence asc"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsEmployeeStatus() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " EmpSta_Code," & _
            " EmpSta_DescriptionL," & _
            " EmpSta_DescriptionS" & _
            " FROM PrSsEmployeeStatus"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsLeaveTypes() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " Lve_Code," & _
            " Lve_DescriptionL," & _
            " Lve_DescriptionS," & _
            " Lve_IsActive," & _
            " Lve_IsPaidPeriod," & _
            " Lve_IsPaidAnnual," & _
            " Lve_UnitOfMeasure," & _
            " Lve_AnnualMax," & _
            " Lve_CarryOverMax" & _
            " FROM PrSsLeaveTypes"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsLimits() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " Lmt_Id," & _
            " Lmt_Cola," & _
            " Lmt_InsurableWk," & _
            " Lmt_InsurableMth," & _
            " Lmt_InsurableAnnual," & _
            " Lmt_DedContrAnnual," & _
            " Lmt_IndAnnual," & _
            " Lmt_EffectiveDate," & _
            " Lmt_UnemAnnual," & _
            " Lmt_GesiD, " & _
            " Lmt_GesiC " & _
            " FROM PrSsLimits"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsMedicalFund() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " MedFnd_Code," & _
            " MedFnd_Desc," & _
            " MedFnd_DedValue," & _
            " MedFnd_ConValue" & _
            " FROM PrSsMedicalFund"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsCommissionRates() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " ComRat_Code," & _
            " ComRat_Desc," & _
            " ComRat_Value " & _
            " FROM PrSsCommissionRates"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsFlightHour() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " FliHou_Code," & _
            " FliHou_Desc," & _
            " FliHou_HourRate," & _
            " FliHou_Limit, " & _
            " FliHou_LimitCode " & _
            " FROM PrSsFlightHour"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsSectorPay() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " SecPay_Code," & _
            " SecPay_Desc," & _
            " SecPay_HourRate " & _
            " FROM PrSsSectorPay"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsPerformanceBonus() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " PerBon_Code," & _
            " PerBon_Desc," & _
            " PerBon_Value, " & _
            " PerBon_Rate, " & _
            " PerBon_Type, " & _
            " PerBon_Formula " & _
            " FROM PrSsPerformanceBonus"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsDutyHours() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " DutHou_Code," & _
            " DutHou_Desc," & _
            " DutHou_HourRate " & _
            " FROM PrSsDutyHours"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsOverLay() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " OveLay_Code," & _
            " OveLay_Desc," & _
            " OveLay_Rate " & _
            " FROM PrSsOverLay"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsParameters(ByVal SortBySection As Boolean) As DataSet
        Dim Str As String = ""
        Dim Str2 As String = ""
        Str = " SELECT " & _
            " Par_Id," & _
            " Par_Section," & _
            " Par_Item," & _
            " Par_Value," & _
            " Par_Description," & _
            " Par_System," & _
            " Par_Type" & _
            " FROM PrSsParameters"

        If SortBySection Then
            str2 = " Order by Par_section asc"
        End If

        Str = Str & Str2

        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsPaymentCategory() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " PayCat_Code," & _
            " PayCat_DescriptionL," & _
            " PayCat_DescriptionS," & _
            " PayCat_IsActive," & _
            " PayCat_Sequence" & _
            " FROM PrSsPaymentCategory"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsPayrollTypes() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " PayTyp_Code," & _
            " PayTyp_DescriptionL," & _
            " PayTyp_DescriptionS," & _
            " PayTyp_IsActive" & _
            " FROM PrSsPayrollTypes"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsPayrollUnits() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " PayUni_Code," & _
            " PayUni_DescriptionL," & _
            " PayUni_DescriptionS" & _
            " FROM PrSsPayrollUnits"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsProvidentFund() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " ProFnd_Code," & _
            " ProFnd_Desc," & _
            " ProFnd_DedValue," & _
            " ProFnd_ConValue," & _
            " ProFnd_Limit," & _
            " ProFnd_NextCode" & _
            " FROM PrSsProvidentFund"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsScales() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " Sca_Id," & _
            " Sca_Type," & _
            " Sca_Sequence," & _
            " Sca_Deduction," & _
            " Sca_Contribution" & _
            " FROM PrSsScales"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsSocialInsPeriods() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " SinPrd_Code," & _
            " SinPrd_DescriptionL," & _
            " SinPrd_DescriptionS" & _
            " FROM PrSsSocialInsPeriods"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsSocialInsurance() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " SocInc_Code," & _
            " SocInc_Desc," & _
            " SocInc_DedValue," & _
            " SocIns_ConValue" & _
            " FROM PrSsSocialInsurance"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsTaxTable() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " TaxTbl_id," & _
            " TaxTbl_Sequence," & _
            " TaxTbl_BracketAmount," & _
            " TaxTbl_BracketRate," & _
            " TaxTbl_CreationDate," & _
            " TaxTbl_CreatedBy," & _
            " TaxTbl_AmendDate," & _
            " TaxTbl_AmendBy" & _
            " FROM PrSsTaxTable "
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsExtraTaxTable() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " ExtTbl_id," & _
            " ExtTbl_Sequence," & _
            " ExtTbl_BracketAmount," & _
            " ExtTbl_DedRate," & _
            " ExtTbl_ConRate," & _
            " ExtTbl_CreationDate," & _
            " ExtTbl_CreatedBy," & _
            " ExtTbl_AmendDate," & _
            " ExtTbl_AmendBy" & _
            " FROM PrSsExtraTaxTable "
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsDecreaseTable() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " DecTbl_id," & _
            " DecTbl_Sequence," & _
            " DecTbl_Code," & _
            " DecTbl_BracketAmount," & _
            " DecTbl_DedRate," & _
            " DecTbl_CreationDate," & _
            " DecTbl_CreatedBy," & _
            " DecTbl_AmendDate," & _
            " DecTbl_AmendBy" & _
            " FROM PrSsDecreaseTable "
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsUnemployment() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " Une_Code," & _
            " Une_Desc," & _
            " Une_DedValue," & _
            " Une_ConValue" & _
            " FROM PrSsUnemployment"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsIndustrial() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " Ind_Code," & _
            " Ind_Desc," & _
            " Ind_DedValue," & _
            " Ind_ConValue" & _
            " FROM PrSsIndustrial"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrSsSocialCohesion() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " SocCoh_Code," & _
            " SocCoh_Desc," & _
            " SocCoh_DedValue," & _
            " SocCoh_ConValue" & _
            " FROM PrSsSocialCohesion"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrTxEmployeeDiscounts() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " EmpDis_id," & _
            " Emp_Code," & _
            " PrdGrp_Code," & _
            " EmpDis_Discount1," & _
            " EmpDis_Discount2," & _
            " EmpDis_Discount3," & _
            " EmpDis_Discount4," & _
            " EmpDis_Discount5," & _
            " EmpDis_Discount6," & _
            " EmpDis_Discount7," & _
            " EmpDis_Discount8," & _
            " EmpDis_Discount9," & _
            " EmpDis_Discount10," & _
            " EmpDis_LifeInsurance," & _
            " Usr_Id," & _
            " EmpDis_CreationDate," & _
            " EmpDis_AmendDate," & _
            " EmpDis_medical " & _
            " FROM PrTxEmployeeDiscounts"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrTxEmployeeHiring() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " EmpHir_id," & _
            " Emp_Code," & _
            " EmpHir_Date," & _
            " EmpHir_StartDate," & _
            " EmpHir_StartSalary," & _
            " EmpHir_PFStartDate," & _
            " Usr_Id" & _
            " FROM PrTxEmployeeHiring"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrTxEmployeeSalary() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " EmpSal_id," & _
            " Emp_Code," & _
            " EmpSal_Date," & _
            " EmpSal_Value," & _
            " EmpSal_Basic," & _
            " EmpSal_EffPayDate," & _
            " EmpSal_EffArrearsDate," & _
            " EmpSal_Cola," & _
            " Usr_Id," & _
            " EmpSal_IsCola," & _
            " EmpSal_Dif" & _
            " FROM PrTxEmployeeSalary"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrTxTrxnHeader() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " TrxHdr_Id," & _
            " Emp_Code," & _
            " PrdCod_Code," & _
            " PayCat_Code," & _
            " TrxHdr_Date," & _
            " TrxHdr_Status," & _
            " TrxHdr_TotalErnPeriod," & _
            " TrxHdr_TotalErnYTD," & _
            " TrxHdr_TotalDedPeriod," & _
            " TrxHdr_TotalDedYTD," & _
            " TrxHdr_TotalConPeriod," & _
            " TrxHdr_TotalConYTD," & _
            " TrxHdr_SIIncome," & _
            " TrxHdr_TaxableIncome," & _
            " TrxHdr_PaymentMethod," & _
            " TrxHdr_PaymentRef," & _
            " TrxHdr_PeriodUnits," & _
            " TrxHdr_AnnualUnits," & _
            " TrxHdr_AnnualLeave" & _
            " FROM PrTxTrxnHeader"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllPrTxTrxnLines() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " TrxLin_Id," & _
            " TrxHdr_Id," & _
            " TrxLin_Type," & _
            " ErnCod_Code," & _
            " DedCod_Code," & _
            " ConCod_Code," & _
            " TrxLin_PeriodValue," & _
            " TrxLin_YTDValue" & _
            " FROM PrTxTrxnLines"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllXXMnColumns() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " MCl_TableName," & _
            " MCl_ColumnName," & _
            " MCl_ClassPropertyName," & _
            " MCl_FormLabelName," & _
            " MCl_TabIndex," & _
            " MCl_RecordLocked," & _
            " ICT_Code" & _
            " FROM XXMnColumns"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllXXMnTables() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " MTb_TableName," & _
            " MTb_FormName," & _
            " MTb_Dir," & _
            " MTb_SubDir," & _
            " FTy_Code" & _
            " FROM XXMnTables"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllXXMsFromType() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " FTy_Code," & _
            " FTy_Description" & _
            " FROM XXMsFromType"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllXXMsInputControlType() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " ICT_Code," & _
            " ICT_Description," & _
            " ICT_Prefix," & _
            " ICT_ObjectName" & _
            " FROM XXMsInputControlType"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllXXSyColumns() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " SCl_TableName," & _
            " SCl_ColumnName," & _
            " SCl_ColumnId," & _
            " SCl_DbType," & _
            " SCl_Length," & _
            " SCl_Scale," & _
            " SCl_Precision," & _
            " SCl_IsInPK," & _
            " SCl_IsInUnique," & _
            " SCl_IsIdentity," & _
            " SCl_IsFK," & _
            " SCl_PKTableName," & _
            " SCl_PKColumnName," & _
            " SCl_SequenceNo," & _
            " SCl_IsNullable," & _
            " SCl_DateTimePrecision" & _
            " FROM XXSyColumns"
        Return GetData(Str)
    End Function
    Protected Function AG_GetAllXXSyTables() As DataSet
        Dim Str As String
        Str = " SELECT " & _
            " STb_TableName," & _
            " STb_ObjectId," & _
            " STb_HasPrimaryKey," & _
            " STb_HasIdentity" & _
            " FROM XXSyTables"
        Return GetData(Str)
    End Function
   


   
End Class
