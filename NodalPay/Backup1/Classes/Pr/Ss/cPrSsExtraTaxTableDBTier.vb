Public Class cPrSsExtraTaxTableDBTier
    ' This Class has been autogenerated by Nodalsoft
    ' Do NOT adjust as it will be overwritten
    ' Generation Date : 13/02/2008 09:42:51
    '
    '
    '
    Inherits cDataTier
    '
    Protected Function GetByPK(ByVal tTaxTbl_id As Integer) As DataSet
        Dim Str As String
        Str = " SELECT" & _
                " ExtTbl_id," & _
                " ExtTbl_Sequence," & _
                " ExtTbl_BracketAmount," & _
                " ExtTbl_DedRate," & _
                " ExtTbl_ConRate," & _
                " ExtTbl_CreationDate," & _
                " ExtTbl_CreatedBy," & _
                " ExtTbl_AmendDate," & _
                " ExtTbl_AmendBy" & _
            "  FROM PrSsExtraTaxTable" & _
            "  WHERE ExtTbl_id = " & tTaxTbl_id
        Return MyBase.GetData(Str)
    End Function
    Protected Function Save(ByRef _cPrSsTaxTable As cPrSsExtraTaxTable) As Boolean
        Dim SpParams As New ArrayList
        Dim SpNames As New ArrayList
        Dim Flag As Boolean = False
        With _cPrSsTaxTable
            SpParams.Add(.TaxTbl_id)                                         '(0)
            SpNames.Add("ExtTbl_id")                                         '(0)
            SpParams.Add(.TaxTbl_Sequence)                                   '(1)
            SpNames.Add("ExtTbl_Sequence")                                   '(1)
            SpParams.Add(.TaxTbl_BracketAmount)                              '(2)
            SpNames.Add("ExtTbl_BracketAmount")                              '(2)
            SpParams.Add(.TaxTbl_DedRate)                                '(3)
            SpNames.Add("ExtTbl_DedRate")                                '(3)
            SpParams.Add(.TaxTbl_ConRate)                                '(3)
            SpNames.Add("ExtTbl_ConRate")                                '(3)
            SpParams.Add(.TaxTbl_CreationDate)                               '(4)
            SpNames.Add("ExtTbl_CreationDate")                               '(4)
            SpParams.Add(.TaxTbl_CreatedBy)                                  '(5)
            SpNames.Add("ExtTbl_CreatedBy")                                  '(5)
            SpParams.Add(.TaxTbl_AmendDate)                                  '(6)
            SpNames.Add("ExtTbl_AmendDate")                                  '(6)
            SpParams.Add(.TaxTbl_AmendBy)                                    '(7)
            SpNames.Add("ExtTbl_AmendBy")                                    '(7)
        End With
        SpNames.Add("NewId")                                             '(8)
        SpParams.Add(CInt(0))                                            '(8)
        If Me.StoredProcedure("AG_PrSsExtraTaxTable_Save_Update", SpParams, SpNames, 9) Then
            If _cPrSsTaxTable.TaxTbl_id = 0 Then
                _cPrSsTaxTable.TaxTbl_id = DbNullToInt(SpParams(9))
            End If
            Return True
        Else
            Return False
        End If
    End Function
    Protected Function Delete(ByVal tTaxTbl_id As Integer) As Boolean
        Dim Str As String
        Dim Flag As Boolean = True
        Dim Exx As New System.Exception
        Try
            BeginTransaction()
            Str = " DELETE FROM PrSsExtraTaxTable" & _
               " WHERE ExtTbl_id = " & tTaxTbl_id
            If MyBase.ExecuteNonQuery(Str) = -1 Then
                Throw Exx
            End If
            CommitTransaction()
        Catch ex As Exception
            Rollback()
            Utils.ShowException(ex)
            Flag = False
        End Try
        Return Flag
    End Function
    Protected Function CheckDeleteRecords(ByVal tCode As Integer) As DataSet
        Dim ds As DataSet
        '    Generation Note : 13/02/2008 09:42:51 :- No Foriegn Key Constraints where found
        ds = Nothing
        Return ds
    End Function
End Class


