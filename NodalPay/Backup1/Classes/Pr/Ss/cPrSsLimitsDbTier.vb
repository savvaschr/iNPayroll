' This Class has been autogenerated by Nodalsoft
' Do NOT adjust as it will be overwritten
' Generation Date : 24/06/2008 11:22:05
'
'
Public Class cPrSsLimitsDbTier
    '
    Inherits cDataTier
    '
    Protected Function GetByPK(ByVal tId As Integer) As DataSet
        Dim Str As String
        Str = " SELECT" & _
                " Lmt_Id," & _
                " Lmt_Cola," & _
                " Lmt_InsurableWk," & _
                " Lmt_InsurableMth," & _
                " Lmt_InsurableAnnual," & _
                " Lmt_DedContrAnnual," & _
                " Lmt_IndAnnual," & _
                " Lmt_UnemAnnual," & _
                " Lmt_EffectiveDate," & _
                " Lmt_GesiD, " & _
                " Lmt_GesiC " & _
                " FROM PrSsLimits " & _
                " WHERE Lmt_Id = " & tId
        Return MyBase.GetData(Str)
    End Function
    Protected Function Save(ByRef _cPrSsLimits As cPrSsLimits) As Boolean
        Dim SpParams As New ArrayList
        Dim SpNames As New ArrayList
        Dim Flag As Boolean = False
        With _cPrSsLimits
            SpParams.Add(.Id)                                                '(0)
            SpNames.Add("Lmt_Id")                                            '(0)
            SpParams.Add(.Cola)                                              '(1)
            SpNames.Add("Lmt_Cola")                                          '(1)
            SpParams.Add(.InsurableWk)                                       '(2)
            SpNames.Add("Lmt_InsurableWk")                                   '(2)
            SpParams.Add(.InsurableMth)                                      '(3)
            SpNames.Add("Lmt_InsurableMth")                                  '(3)
            SpParams.Add(.InsurableAnnual)                                   '(4)
            SpNames.Add("Lmt_InsurableAnnual")                               '(4)
            SpParams.Add(.DedContrAnnual)                                    '(5)
            SpNames.Add("Lmt_DedContrAnnual")                                '(5)
            SpParams.Add(.IndAnnual)                                         '(6)
            SpNames.Add("Lmt_IndAnnual")                                     '(6)
            SpParams.Add(.UnemAnnual)                                        '(7)
            SpNames.Add("Lmt_UnemAnnual")                                    '(7)
            SpParams.Add(.EffectiveDate)                                     '(8)
            SpNames.Add("Lmt_EffectiveDate")                                 '(8)
            SpParams.Add(.GesiD)                                             '(9)
            SpNames.Add("Lmt_GesiD")                                         '(9)
            SpParams.Add(.GesiC)                                             '(10)
            SpNames.Add("Lmt_GesiC")                                         '(10)
        End With
        SpNames.Add("NewId")                                             '(11)
        SpParams.Add(CInt(0))                                            '(11)
        If Me.StoredProcedure("AG_PrSsLimits_Save_Update", SpParams, SpNames, 11) Then
            If _cPrSsLimits.Id = 0 Then
                _cPrSsLimits.Id = DbNullToInt(SpParams(9))
            End If
            Return True
        Else
            Return False
        End If
    End Function
    Protected Function Delete(ByVal tId As Integer) As Boolean
        Dim Str As String
        Dim Flag As Boolean = True
        Dim Exx As New System.Exception
        Try
            BeginTransaction()
            Str = " DELETE FROM PrSsLimits" & _
               " WHERE Lmt_Id = " & tId
            If MyBase.ExecuteNonQuery(Str) = -1 Then
                Throw Exx
            End If
            CommitTransaction()
        Catch ex As Exception
            Rollback()
            Utils.ShowException(ex)
            Flag = False
        End Try
        Return Flag

    End Function
    Protected Function CheckDeleteRecords(ByVal tCode As Integer) As DataSet
        Dim ds As DataSet
        '    Generation Note : 24/06/2008 11:22:06 :- No Foriegn Key Constraints where found
        ds = Nothing
        Return ds
    End Function
End Class
