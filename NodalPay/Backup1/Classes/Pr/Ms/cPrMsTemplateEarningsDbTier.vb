' This Class has been autogenerated by Nodalsoft
' Do NOT adjust as it will be overwritten
' Generation Date : 13/02/2008 09:42:50
'
'
Public Class cPrMsTemplateEarningsDbTier
    '
    Inherits cDataTier
    '
    Protected Function GetByPK(ByVal tId As Integer) As DataSet
        Dim Str As String
        Str = " SELECT" & _
                " TemErn_id," & _
                " TemGrp_Code," & _
                " ErnCod_Code," & _
                " TemErn_DisplayName," & _
                " TemErn_IsDispalyed," & _
                " TemErn_Sequence," & _
                " TemErn_TypeMode," & _
                " TemErn_FromMode," & _
                " TemErn_CalcFormula," & _
                " TemErn_CreationDate," & _
                " TemErn_CreatedBy," & _
                " TemErn_AmendDate," & _
                " TemErn_AmendBy" & _
                " TemErn_NavCreditAccount," & _
                " TemErn_NavDebitAccount," & _
                " TemErn_ReportingSequence " & _
            "  FROM PrMsTemplateEarnings" & _
            "  WHERE TemErn_id = " & tId
        Return MyBase.GetData(Str)
    End Function
    Protected Function GetByIndex(ByVal tTemplateGroupCode As String, ByVal tEarningCode As String) As DataSet
        Dim Str As String
        Str = " SELECT" & _
                " TemErn_id," & _
                " TemGrp_Code," & _
                " ErnCod_Code," & _
                " TemErn_DisplayName," & _
                " TemErn_IsDispalyed," & _
                " TemErn_Sequence," & _
                " TemErn_TypeMode," & _
                " TemErn_FromMode," & _
                " TemErn_CalcFormula," & _
                " TemErn_CreationDate," & _
                " TemErn_CreatedBy," & _
                " TemErn_AmendDate," & _
                " TemErn_AmendBy," & _
                " TemErn_NavCreditAccount," & _
                " TemErn_NavDebitAccount," & _
                " TemErn_ReportingSequence " & _
                "  FROM PrMsTemplateEarnings" & _
                "  WHERE TemGrp_Code = " & enQuoteString(tTemplateGroupCode) & _
                "  AND ErnCod_Code=" & enQuoteString(tEarningCode)
        Return MyBase.GetData(Str)
    End Function
    Protected Function Save(ByRef _cPrMsTemplateEarnings As cPrMsTemplateEarnings) As Boolean
        Dim SpParams As New ArrayList
        Dim SpNames As New ArrayList
        Dim Flag As Boolean = False
        With _cPrMsTemplateEarnings
            SpParams.Add(.Id)                                                '(0)
            SpNames.Add("TemErn_id")                                         '(0)
            SpParams.Add(.TemGrpCode)                                        '(1)
            SpNames.Add("TemGrp_Code")                                       '(1)
            SpParams.Add(.ErnCodCode)                                        '(2)
            SpNames.Add("ErnCod_Code")                                       '(2)
            SpParams.Add(.DisplayName)                                       '(3)
            SpNames.Add("TemErn_DisplayName")                                '(3)
            SpParams.Add(.IsDispalyed)                                       '(4)
            SpNames.Add("TemErn_IsDispalyed")                                '(4)
            SpParams.Add(.Sequence)                                          '(5)
            SpNames.Add("TemErn_Sequence")                                   '(5)
            SpParams.Add(.TypeMode)                                          '(6)
            SpNames.Add("TemErn_TypeMode")                                   '(6)
            SpParams.Add(.FromMode)                                          '(7)
            SpNames.Add("TemErn_FromMode")                                   '(7)
            SpParams.Add(.CalcFormula)                                       '(8)
            SpNames.Add("TemErn_CalcFormula")                                '(8)
            SpParams.Add(.CreationDate)                                      '(9)
            SpNames.Add("TemErn_CreationDate")                               '(9)
            SpParams.Add(.CreatedBy)                                         '(10)
            SpNames.Add("TemErn_CreatedBy")                                  '(10)
            SpParams.Add(.AmendDate)                                         '(11)
            SpNames.Add("TemErn_AmendDate")                                  '(11)
            SpParams.Add(.AmendBy)                                           '(12)
            SpNames.Add("TemErn_AmendBy")                                    '(12)
            SpParams.Add(.ConsolDesc)                                  '(13)
            SpNames.Add("TemErn_NavCreditAccount")                           '(13)
            SpParams.Add(.NavDebitAccount)                                   '(14)
            SpNames.Add("TemErn_NavDebitAccount")                            '(14)
            SpParams.Add(.ReportingSequence)                                   '(15)
            SpNames.Add("TemErn_ReportingSequence")                            '(15)
        End With
        SpNames.Add("NewId")                                             '(16)
        SpParams.Add(CInt(0))                                            '(16)
        If Me.StoredProcedure("AG_PrMsTemplateEarnings_Save_Update", SpParams, SpNames, 16) Then
            If _cPrMsTemplateEarnings.Id = 0 Then
                _cPrMsTemplateEarnings.Id = DbNullToInt(SpParams(16))
            End If
            Return True
        Else
            Return False
        End If
    End Function
    Protected Function Delete(ByVal tId As Integer) As Boolean
        Dim Str As String
        Dim Flag As Boolean = True
        Dim Exx As New System.Exception
        Try
            BeginTransaction()
            Str = " DELETE FROM PrMsTemplateEarnings" & _
               " WHERE TemErn_id = " & tId
            If MyBase.ExecuteNonQuery(Str) = -1 Then
                Throw Exx
            End If
            CommitTransaction()
        Catch ex As Exception
            Rollback()
            Utils.ShowException(ex)
            Flag = False
        End Try
        Return Flag
    End Function
    Protected Function CheckDeleteRecords(ByVal tCode As Integer) As DataSet
        Dim ds As DataSet
        '    Generation Note : 13/02/2008 09:42:50 :- No Foriegn Key Constraints where found
        ds = Nothing
        Return ds
    End Function
End Class
