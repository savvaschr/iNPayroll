' This Class has been autogenerated by Nodalsoft
' Do NOT adjust as it will be overwritten
' Generation Date : 26/03/2008 11:03:31
'
'
Public Class cPrMsEmployeesDbTier
    '
    Inherits cDataTier
    '
    Protected Function GetByPK(ByVal tCode As String) As DataSet
        Dim Str As String
        Str = " SELECT" & _
                " Emp_Code," & _
                " Emp_Status," & _
                " PayTyp_Code," & _
                " TemGrp_Code," & _
                " EmpSta_Code," & _
                " Emp_Title," & _
                " Emp_LastName," & _
                " Emp_FirstName," & _
                " Emp_FullName," & _
                " Emp_Sex," & _
                " Emp_BirthDate," & _
                " MarSta_Code," & _
                " Emp_Address1," & _
                " Emp_Address2," & _
                " Emp_Address3," & _
                " Emp_PostCode," & _
                " Emp_Telephone1," & _
                " Emp_Telephone2," & _
                " Emp_Email," & _
                " Emp_SocialInsNumber," & _
                " ComSin_EmpSocialInsNo," & _
                " Emp_IdentificationCard," & _
                " Emp_TaxID," & _
                " Emp_PassportNumber," & _
                " Emp_AlienNumber," & _
                " TicTyp_Code," & _
                " EmpAn1_Code," & _
                " EmpAn2_Code," & _
                " EmpAn3_Code," & _
                " EmpAn4_Code," & _
                " EmpAn5_Code," & _
                " Uni_Code," & _
                " Cou_Code," & _
                " EmpPos_Code," & _
                " Sic_Code," & _
                " EmpCmm_Code," & _
                " PayUni_Code," & _
                " Emp_PeriodUnits," & _
                " Emp_AnnualUnits," & _
                " Cur_Code," & _
                " PmtMth_Code," & _
                " Bnk_Code," & _
                " Emp_BankAccount," & _
                " Bnk_CodeCo," & _
                " Emp_BankAccountCo," & _
                " Emp_StartDate," & _
                " Emp_TerminateDate," & _
                " Emp_OtherIncome1," & _
                " Emp_OtherIncome2," & _
                " Emp_OtherIncome3," & _
                " Emp_PreviousEarnings," & _
                " Emp_PrevSIDeduct," & _
                " Emp_PrevSIContribute," & _
                " Emp_PrevITDeduct," & _
                " Emp_PrevPFDeduct," & _
                " ProFnd_Code," & _
                " MedFnd_Code," & _
                " SocInc_Code," & _
                " Ind_Code," & _
                " Une_Code," & _
                " SocCoh_Code," & _
                " Emp_CreationDate," & _
                " Emp_CreatedBy," & _
                " Emp_AmendDate," & _
                " Emp_AmendBy," & _
                " IntTem_Code," & _
                " Emp_GLAnal1," & _
                " Emp_GLAnal2, " & _
                " Emp_GLAnal3," & _
                " Emp_GLAnal4, " & _
                " IntTem_PFCode," & _
                " IntTem_MFCode," & _
                " Emp_PensionNo," & _
                " Emp_DrivingLicense," & _
                " Emp_HasSI, " & _
                " Emp_PensionType, " & _
                " Emp_MyPayslipReport, " & _
                " Emp_IBAN, " & _
                " Emp_PreviousLifeIns, " & _
                " Emp_PreviousDis," & _
                " Emp_PreviousST," & _
                " Emp_OtherIncome4," & _
                " SecPay_Code, " & _
                " ComRat_Code, " & _
                " PerBon_Code, " & _
                " DutHou_Code, " & _
                " FliHou_Code," & _
                " Emp_PassFullName," & _
                " Emp_TravelDocs, " & _
                " Emp_FirstEmployment, " & _
                " OveLay_Code, " & _
                " Emp_Password, " & _
                " Emp_Splitemployement, " & _
                " Emp_NewEmployee, " & _
                " Emp_Force50Percent, " & _
                " Emp_Notes, " & _
                " Emp_BankBenName, " & _
                " Emp_AgreedSalary, " & _
                " Emp_BonusOnSalary, " & _
                " Emp_TaxForSplit, " & _
                " Emp_PrevMF, " & _
                " Emp_PrevPenF, " & _
                " Emp_50PerOff, " & _
                " Ges_Code, " & _
                " Emp_PrevGesiD," & _
                " Emp_PrevGesiC, " & _
                " Emp_LWBPen, " & _
                " Emp_GESYFromSplit, " & _
                " Emp_AnalGen1, " & _
                " Emp_NameDay, " & _
                " Emp_IsDirector, " & _
                " Emp_Rehire, " & _
                " Emp_CNP, " & _
                " Emp_TACode, " & _
                " Emp_HRCode, " & _
                " Emp_TermReason, " & _
                " Emp_HireReason, " & _
                " Emp_Photo, " & _
                " Emp_Email2, " & _
                " Emp_Maternity, " & _
                " Emp_FEControlAmount " & _
            "  FROM PrMsEmployees" & _
            "  WHERE Emp_Code = '" & tCode & "'"
        Return MyBase.GetData(Str)

    End Function
    Protected Function Save(ByVal _cPrMsEmployees As cPrMsEmployees, ByVal SavePhoto As Boolean) As Boolean
        Dim SpParams As New ArrayList
        Dim SpNames As New ArrayList
        Dim Flag As Boolean = False
        With _cPrMsEmployees
            SpParams.Add(.Code)                                              '(0)
            SpNames.Add("Emp_Code")                                          '(0)

            SpParams.Add(.Status)                                            '(1)
            SpNames.Add("Emp_Status")                                        '(1)

            SpParams.Add(.PayTyp_Code)                                       '(2)
            SpNames.Add("PayTyp_Code")                                       '(2)

            SpParams.Add(.TemGrp_Code)                                       '(3)
            SpNames.Add("TemGrp_Code")                                       '(3)

            SpParams.Add(.EmpSta_Code)                                       '(4)
            SpNames.Add("EmpSta_Code")                                       '(4)

            SpParams.Add(.Title)                                             '(5)
            SpNames.Add("Emp_Title")                                         '(5)

            SpParams.Add(.LastName)                                          '(6)
            SpNames.Add("Emp_LastName")                                      '(6)

            SpParams.Add(.FirstName)                                         '(7)
            SpNames.Add("Emp_FirstName")                                     '(7)

            SpParams.Add(.FullName)                                          '(8)
            SpNames.Add("Emp_FullName")                                      '(8)

            SpParams.Add(.Sex)                                               '(9)
            SpNames.Add("Emp_Sex")                                           '(9)

            SpParams.Add(.BirthDate)                                         '(10)
            SpNames.Add("Emp_BirthDate")                                     '(10)

            SpParams.Add(.MarSta_Code)                                       '(11)
            SpNames.Add("MarSta_Code")                                       '(11)

            SpParams.Add(.Address1)                                          '(12)
            SpNames.Add("Emp_Address1")                                      '(12)

            SpParams.Add(.Address2)                                          '(13)
            SpNames.Add("Emp_Address2")                                      '(13)

            SpParams.Add(.Address3)                                          '(14)
            SpNames.Add("Emp_Address3")                                      '(14)

            SpParams.Add(.PostCode)                                          '(15)
            SpNames.Add("Emp_PostCode")                                      '(15)

            SpParams.Add(.Telephone1)                                        '(16)
            SpNames.Add("Emp_Telephone1")                                    '(16)

            SpParams.Add(.Telephone2)                                        '(17)
            SpNames.Add("Emp_Telephone2")                                    '(17)

            SpParams.Add(.Email)                                             '(18)
            SpNames.Add("Emp_Email")                                         '(18)

            SpParams.Add(.SocialInsNumber)                                   '(19)
            SpNames.Add("Emp_SocialInsNumber")                               '(19)

            SpParams.Add(.ComSin_EmpSocialInsNo)                             '(20)
            SpNames.Add("ComSin_EmpSocialInsNo")                             '(20)

            SpParams.Add(.IdentificationCard)                                '(21)
            SpNames.Add("Emp_IdentificationCard")                            '(21)

            SpParams.Add(.TaxID)                                             '(22)
            SpNames.Add("Emp_TaxID")                                         '(22)

            SpParams.Add(.PassportNumber)                                    '(23)
            SpNames.Add("Emp_PassportNumber")                                '(23)

            SpParams.Add(.AlienNumber)                                       '(24)
            SpNames.Add("Emp_AlienNumber")                                   '(24)

            SpParams.Add(.TicTyp_Code)                                       '(25)
            SpNames.Add("TicTyp_Code")                                       '(25)

            SpParams.Add(.EmpAn1_Code)                                       '(26)
            SpNames.Add("EmpAn1_Code")                                       '(26)

            SpParams.Add(.EmpAn2_Code)                                       '(27)
            SpNames.Add("EmpAn2_Code")                                       '(27)

            SpParams.Add(.EmpAn3_Code)                                       '(28)
            SpNames.Add("EmpAn3_Code")                                       '(28)

            SpParams.Add(.EmpAn4_Code)                                       '(29)
            SpNames.Add("EmpAn4_Code")                                       '(29)

            SpParams.Add(.EmpAn5_Code)                                       '(30)
            SpNames.Add("EmpAn5_Code")                                       '(30)

            SpParams.Add(.Uni_Code)                                          '(31)
            SpNames.Add("Uni_Code")                                          '(31)

            SpParams.Add(.Cou_Code)                                          '(32)
            SpNames.Add("Cou_Code")                                          '(32)

            SpParams.Add(.EmpPos_Code)                                       '(33)
            SpNames.Add("EmpPos_Code")                                       '(33)

            SpParams.Add(.Sic_Code)                                          '(34)
            SpNames.Add("Sic_Code")                                          '(34)

            SpParams.Add(.EmpCmm_Code)                                       '(35)
            SpNames.Add("EmpCmm_Code")                                       '(35)

            SpParams.Add(.PayUni_Code)                                       '(36)
            SpNames.Add("PayUni_Code")                                       '(36)

            SpParams.Add(.PeriodUnits)                                       '(37)
            SpNames.Add("Emp_PeriodUnits")                                   '(37)

            SpParams.Add(.AnnualUnits)                                       '(38)
            SpNames.Add("Emp_AnnualUnits")                                   '(38)

            SpParams.Add(.Cur_Code)                                          '(39)
            SpNames.Add("Cur_Code")                                          '(39)

            SpParams.Add(.PmtMth_Code)                                       '(40)
            SpNames.Add("PmtMth_Code")                                       '(40)

            SpParams.Add(.Bnk_Code)                                          '(41)
            SpNames.Add("Bnk_Code")                                          '(41)

            SpParams.Add(.BankAccount)                                       '(42)
            SpNames.Add("Emp_BankAccount")                                   '(42)

            SpParams.Add(.Bnk_CodeCo)                                        '(43)
            SpNames.Add("Bnk_CodeCo")                                        '(43)

            SpParams.Add(.BankAccountCo)                                     '(44)
            SpNames.Add("Emp_BankAccountCo")                                 '(44)

            SpParams.Add(.StartDate)                                         '(45)
            SpNames.Add("Emp_StartDate")                                     '(45)

            SpParams.Add(.TerminateDate)                                     '(46)
            SpNames.Add("Emp_TerminateDate")                                 '(46)

            SpParams.Add(.OtherIncome1)                                      '(47)
            SpNames.Add("Emp_OtherIncome1")                                  '(47)

            SpParams.Add(.OtherIncome2)                                      '(48)
            SpNames.Add("Emp_OtherIncome2")                                  '(48)

            SpParams.Add(.OtherIncome3)                                      '(49)
            SpNames.Add("Emp_OtherIncome3")                                  '(49)

            SpParams.Add(.PreviousEarnings)                                  '(50)
            SpNames.Add("Emp_PreviousEarnings")                              '(50)

            SpParams.Add(.Emp_PrevSIDeduct)                                  '(51)
            SpNames.Add("Emp_PrevSIDeduct")                                  '(51)

            SpParams.Add(.Emp_PrevSIContribute)                              '(52)
            SpNames.Add("Emp_PrevSIContribute")                              '(52)

            SpParams.Add(.Emp_PrevITDeduct)                                  '(53)
            SpNames.Add("Emp_PrevITDeduct")                                  '(53)

            SpParams.Add(.Emp_PrevPFDeduct)                                  '(54)
            SpNames.Add("Emp_PrevPFDeduct")                                  '(54)

            SpParams.Add(.ProFnd_Code)                                       '(55)
            SpNames.Add("ProFnd_Code")                                       '(55)

            SpParams.Add(.MedFnd_Code)                                       '(56)
            SpNames.Add("MedFnd_Code")                                       '(56)

            SpParams.Add(.SocInc_Code)                                       '(57)
            SpNames.Add("SocInc_Code")                                       '(57)

            SpParams.Add(.Ind_Code)                                          '(58)
            SpNames.Add("Ind_Code")                                          '(58)

            SpParams.Add(.Une_Code)                                          '(59)
            SpNames.Add("Une_Code")                                          '(59)

            SpParams.Add(.SocCoh_Code)                                       '(60)
            SpNames.Add("SocCoh_Code")                                       '(60)

            SpParams.Add(.CreationDate)                                      '(61)
            SpNames.Add("Emp_CreationDate")                                  '(61)

            SpParams.Add(.CreatedBy)                                         '(62)
            SpNames.Add("Emp_CreatedBy")                                     '(62)

            SpParams.Add(.AmendDate)                                         '(63)
            SpNames.Add("Emp_AmendDate")                                     '(63)

            SpParams.Add(.AmendBy)                                           '(64)
            SpNames.Add("Emp_AmendBy")                                       '(64)

            SpParams.Add(.InterfaceTemCode)                                  '(65)
            SpNames.Add("IntTem_Code")                                       '(65)

            SpParams.Add(.Emp_GLAnal1)                                       '(66)
            SpNames.Add("Emp_GLAnal1")                                       '(66)

            SpParams.Add(.Emp_GLAnal2)                                       '(67)
            SpNames.Add("Emp_GLAnal2")                                       '(67)

            SpParams.Add(.Emp_GLAnal3)                                       '(68)
            SpNames.Add("Emp_GLAnal3")                                       '(68)

            SpParams.Add(.Emp_GLAnal4)                                       '(69)
            SpNames.Add("Emp_GLAnal4")                                       '(69)

            SpParams.Add(.InterfacePFCode)                                   '(70)
            SpNames.Add("IntTem_PFCode")                                     '(70)

            SpParams.Add(.InterfaceMFCode)                                   '(71)
            SpNames.Add("IntTem_MFCode")                                     '(71)

            SpParams.Add(.PensionNo)                                         '(72)
            SpNames.Add("Emp_PensionNo")                                     '(72)

            SpParams.Add(.DrivingLicense)                                    '(73)
            SpNames.Add("Emp_DrivingLicense")                                '(73)

            SpParams.Add(.IsSI)                                              '(74)
            SpNames.Add("Emp_HasSI")                                         '(74)

            SpParams.Add(.PensionType)                                       '(75)
            SpNames.Add("Emp_PensionType")                                   '(75)

            SpParams.Add(.MyPayslipReport)                                   '(76)
            SpNames.Add("Emp_MyPayslipReport")                               '(76)

            SpParams.Add(.IBAN)                                              '(77)
            SpNames.Add("Emp_Iban")                                          '(77)

            SpParams.Add(.PreviousLifeIns)                                   '(78)
            SpNames.Add("Emp_PreviousLifeIns")                               '(78)

            SpParams.Add(.PreviousDis)                                       '(79)
            SpNames.Add("Emp_PreviousDis")                                   '(79)

            SpParams.Add(.PreviousST)                                        '(80)
            SpNames.Add("Emp_PreviousST")                                    '(80)

            SpParams.Add(.OtherIncome4)                                      '(81)
            SpNames.Add("Emp_OtherIncome4")                                  '(81)

            SpParams.Add(.SectorPay)                                         '(82)
            SpNames.Add("SecPay_Code")                                       '(82)

            SpParams.Add(.CommissionRate)                                    '(83)
            SpNames.Add("ComRat_Code")                                       '(83)

            SpParams.Add(.PerformanceBonus)                                  '(84)
            SpNames.Add("PerBon_Code")                                       '(84)

            SpParams.Add(.DutyHours)                                         '(85)
            SpNames.Add("DutHou_Code")                                       '(85)

            SpParams.Add(.FlightHours)                                       '(86)
            SpNames.Add("FliHou_Code")                                       '(86)

            SpParams.Add(.FullPassName)                                       '(87)
            SpNames.Add("Emp_PassFullName")

            SpParams.Add(.Traveldocs)                                       '(88)
            SpNames.Add("Emp_TravelDocs")

            SpParams.Add(.FirstEmployment)                                       '(89)
            SpNames.Add("Emp_FirstEmployment")

            SpParams.Add(.OverLay)                                       '(90)
            SpNames.Add("OveLay_Code")

            SpParams.Add(.Password)                                       '(91)
            SpNames.Add("Emp_Password")

            SpParams.Add(.Splitemployement)                                       '(92)
            SpNames.Add("Emp_Splitemployement")                           '(92)

            SpParams.Add(.NewEmployee)                                       '(93)
            SpNames.Add("Emp_NewEmployee")                           '(93)

            SpParams.Add(.Force50Percent)                               '(94)
            SpNames.Add("Emp_Force50Percent")                           '(94)

            SpParams.Add(.Notes)                               '(95)
            SpNames.Add("Emp_Notes")                           '(95)

            SpParams.Add(.BankBenName)                               '(96)
            SpNames.Add("Emp_BankBenName")                           '(96)

            SpParams.Add(.AgreedSalary)                               '(97)
            SpNames.Add("Emp_AgreedSalary")                           '(97)

            SpParams.Add(.BonusOnsalary)                               '(98)
            SpNames.Add("Emp_BonusOnsalary")                           '(98)

            SpParams.Add(.TaxForSplit)                               '(99)
            SpNames.Add("Emp_TaxForSplit")                           '(99)

            SpParams.Add(.PrevMedFund)                               '(100
            SpNames.Add("Emp_PrevMF")                               '(100

            SpParams.Add(.PrevPensionFund)                               '(101)
            SpNames.Add("Emp_PrevPenF")                             '(101)

            SpParams.Add(.f50PercOff)                               '(102)
            SpNames.Add("Emp_50PerOff")                             '(102)

            SpParams.Add(.GESICode)                               '(103)
            SpNames.Add("Ges_Code")                             '(103)

            SpParams.Add(.PreviousGesiD)                               '(104)
            SpNames.Add("Emp_PrevGesiD")                             '(104)

            SpParams.Add(.PreviousGesiC)                               '(105)
            SpNames.Add("Emp_PrevGesiC")                             '(105)

            SpParams.Add(.LWBPen)                               '(106)
            SpNames.Add("Emp_LWBPen")                             '(106)

            SpParams.Add(.GesyFromSplit)                               '(107)
            SpNames.Add("Emp_GESYFromSplit")                             '(107)

            SpParams.Add(.AnalGen1)                               '(108)
            SpNames.Add("Emp_AnalGen1")                             '(108)

            SpParams.Add(.NameDay)                               '(109)
            SpNames.Add("Emp_NameDay")                             '(109)

            SpParams.Add(.IsDirector)                               '(110)
            SpNames.Add("Emp_IsDirector")                             '(110)

            SpParams.Add(.Rehire)                               '(111)
            SpNames.Add("Emp_Rehire")                             '(111)

            SpParams.Add(.CNPCode)                               '(112)
            SpNames.Add("Emp_CNP")                             '(112)

            SpParams.Add(.TACode)                               '(113)
            SpNames.Add("Emp_TACode")                             '(113)

            SpParams.Add(.HRCode)                               '(114)
            SpNames.Add("Emp_HRCode")                             '(114)

            SpParams.Add(.TermReason)                               '(114)
            SpNames.Add("Emp_TermReason")                             '(114)

            SpParams.Add(.HireReason)                               '(114)
            SpNames.Add("Emp_HireReason")                             '(114)

            '    SpParams.Add(.PreviousInsurableForGESY)                   '(112)
            '    SpNames.Add("Emp_PreviousInsGesy")                        '(112)
            If Not SavePhoto Then
                .MyPhoto = My.Resources.photo
            End If
            Dim ms As New System.IO.MemoryStream()
            Dim bmpImage As New Bitmap(.MyPhoto)
            bmpImage.Save(ms, System.Drawing.Imaging.ImageFormat.Jpeg)
            Dim data As Byte() = ms.GetBuffer()

            SpParams.Add(data)                               '(115)
            SpNames.Add("Emp_Photo")                             '(115)

            SpParams.Add(.Email2)                               '(115)
            SpNames.Add("Emp_Email2")                             '(115)

            SpParams.Add(.Maternity)                               '(115)
            SpNames.Add("Emp_Maternity")                             '(115)

            SpParams.Add(.FEControlAmount)                               '(115)
            SpNames.Add("Emp_FEControlAmount")                             '(115)


        End With
        If Me.StoredProcedure("PrMsEmployees_Save_Update", SpParams, SpNames) Then
            Return True
        Else
            Return False
        End If
    End Function
    Protected Function Delete(ByVal tCode As String) As Boolean
        Dim Str As String
        Dim Flag As Boolean = True
        Dim Exx As New System.Exception
        Try
            BeginTransaction()
            Str = " DELETE FROM PrTxEmployeeSalary Where emp_code =" & enQuoteString(tCode)
            If MyBase.ExecuteNonQuery(Str) = -1 Then
                Throw Exx
            End If

            Str = " DELETE FROM PrTxEmployeeDiscounts Where emp_code =" & enQuoteString(tCode)
            If MyBase.ExecuteNonQuery(Str) = -1 Then
                Throw Exx
            End If

            Str = " DELETE FROM PrMsEmployeeEarnings Where emp_code =" & enQuoteString(tCode)
            If MyBase.ExecuteNonQuery(Str) = -1 Then
                Throw Exx
            End If

            Str = " DELETE FROM PrMsEmployeeDeductions Where emp_code =" & enQuoteString(tCode)
            If MyBase.ExecuteNonQuery(Str) = -1 Then
                Throw Exx
            End If

            Str = " DELETE FROM PrMsEmployeeContributions Where emp_code =" & enQuoteString(tCode)
            If MyBase.ExecuteNonQuery(Str) = -1 Then
                Throw Exx
            End If

            Str = " DELETE FROM PrMsreminders Where emp_code =" & enQuoteString(tCode)
            If MyBase.ExecuteNonQuery(Str) = -1 Then
                Throw Exx
            End If

            Str = "DELETE FROM PrTxLoanComments WHERE  emp_code =" & enQuoteString(tCode)
            If MyBase.ExecuteNonQuery(Str) = -1 Then
                Throw Exx
            End If

            Str = " DELETE FROM PrMsEmployees Where emp_code =" & enQuoteString(tCode)
            If MyBase.ExecuteNonQuery(Str) = -1 Then
                Throw Exx
            End If

            CommitTransaction()
        Catch ex As Exception
            Rollback()
            Utils.ShowException(ex)
            Flag = False
        End Try
        Return Flag
    End Function
    Protected Function CheckDeleteRecords(ByVal tCode As String) As DataSet
        Dim Str As String
        Str = "SELECT * " & _
        " FROM PrTxTrxnHeader" & _
        " WHERE Emp_Code = " & enQuoteString(tCode)
        
        Return GetData(Str)
    End Function
End Class
