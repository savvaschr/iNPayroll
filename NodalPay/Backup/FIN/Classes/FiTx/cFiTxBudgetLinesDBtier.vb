' This Class has been autogenerated by Nodalsoft
' Do NOT adjust as it will be overwritten
' Generation Date : 06/11/07 9:50:35 AM
'
'
Public Class cFiTxBudgetLinesDbTier
    '
    Inherits cDataTier
    '
    Protected Function GetByPK(ByVal tBudLin_Id As Integer) As DataSet
        Dim Str As String
        Str = " SELECT" & _
                " BudLin_Id," & _
                " Bud_Code," & _
                " Prd_Code," & _
                " Acc_Code," & _
                " AcLAn1_Code," & _
                " AcLAn2_Code," & _
                " AcLAn3_Code," & _
                " AcLAn4_Code," & _
                " AcLAn5_Code," & _
                " AcLAn6_Code," & _
                " AcLAn7_Code," & _
                " AcLAn8_Code," & _
                " AcLAn9_Code," & _
                " AcLAn10_Code," & _
                " BudLin_Amount," & _
                " BudLin_CreationDate," & _
                " BudLin_AmendDate," & _
                " BudLin_CreatedBy," & _
                " BudLin_AmendBy" & _
            "  FROM FiTxBudgetLines" & _
            "  WHERE BudLin_Id = " & tBudLin_Id
        Return MyBase.GetData(Str)
    End Function
    Protected Function Save(ByRef _cFiTxBudgetLines As cFiTxBudgetLines) As Boolean
        Dim SpParams As New ArrayList
        Dim SpNames As New ArrayList
        Dim Flag As Boolean = False
        With _cFiTxBudgetLines
            SpParams.Add(.BudLin_Id)                                         '(0)
            SpNames.Add("BudLin_Id")                                         '(0)
            SpParams.Add(.Bud_Code)                                          '(1)
            SpNames.Add("Bud_Code")                                          '(1)
            SpParams.Add(.Prd_Code)                                          '(2)
            SpNames.Add("Prd_Code")                                          '(2)
            SpParams.Add(.Acc_Code)                                          '(3)
            SpNames.Add("Acc_Code")                                          '(3)
            SpParams.Add(.AcLAn1_Code)                                       '(4)
            SpNames.Add("AcLAn1_Code")                                       '(4)
            SpParams.Add(.AcLAn2_Code)                                       '(5)
            SpNames.Add("AcLAn2_Code")                                       '(5)
            SpParams.Add(.AcLAn3_Code)                                       '(6)
            SpNames.Add("AcLAn3_Code")                                       '(6)
            SpParams.Add(.AcLAn4_Code)                                       '(7)
            SpNames.Add("AcLAn4_Code")                                       '(7)
            SpParams.Add(.AcLAn5_Code)                                       '(8)
            SpNames.Add("AcLAn5_Code")                                       '(8)
            SpParams.Add(.AcLAn6_Code)                                       '(9)
            SpNames.Add("AcLAn6_Code")                                       '(9)
            SpParams.Add(.AcLAn7_Code)                                       '(10)
            SpNames.Add("AcLAn7_Code")                                       '(10)
            SpParams.Add(.AcLAn8_Code)                                       '(11)
            SpNames.Add("AcLAn8_Code")                                       '(11)
            SpParams.Add(.AcLAn9_Code)                                       '(12)
            SpNames.Add("AcLAn9_Code")                                       '(12)
            SpParams.Add(.AcLAn10_Code)                                      '(13)
            SpNames.Add("AcLAn10_Code")                                      '(13)
            SpParams.Add(.BudLin_Amount)                                     '(14)
            SpNames.Add("BudLin_Amount")                                     '(14)
            SpParams.Add(.BudLin_CreationDate)                               '(15)
            SpNames.Add("BudLin_CreationDate")                               '(15)
            SpParams.Add(.BudLin_AmendDate)                                  '(16)
            SpNames.Add("BudLin_AmendDate")                                  '(16)
            SpParams.Add(.BudLin_CreatedBy)                                  '(17)
            SpNames.Add("BudLin_CreatedBy")                                  '(17)
            SpParams.Add(.BudLin_AmendBy)                                    '(18)
            SpNames.Add("BudLin_AmendBy")                                    '(18)
        End With
        SpNames.Add("NewId")                                                 '(19)
        SpParams.Add(CInt(0))                                                '(19)
        If Me.StoredProcedure("AG_FiTxBudgetLines_Save_Update", SpParams, SpNames, 19) Then
            If _cFiTxBudgetLines.BudLin_Id = 0 Then
                _cFiTxBudgetLines.BudLin_Id = DbNullToInt(SpParams(19))
            End If
            Return True
        Else
            Return False
        End If
    End Function
    Protected Function Delete(ByVal tBudLin_Id As Integer) As Boolean
        Dim Str As String
        Dim Flag As Boolean = True
        Dim Exx As System.Exception
        Try
            BeginTransaction()
            Str = " DELETE FROM FiTxBudgetLines" & _
               " WHERE BudLin_Id = " & tBudLin_Id
            If MyBase.ExecuteNonQuery(Str) = -1 Then
                Throw Exx
            End If
            CommitTransaction()
        Catch ex As Exception
            Rollback()
            Utils.ShowException(ex)
            Flag = False
        End Try
        Return Flag
    End Function
    Protected Function CheckDeleteRecords(ByVal tCode As Integer) As DataSet
        Dim ds As DataSet
        '    Generation Note : 06/11/07 9:50:35 AM :- No Foriegn Key Constraints where found
        ds = Nothing
        Return ds
    End Function
End Class
